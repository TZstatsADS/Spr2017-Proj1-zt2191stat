filter(term %in% c("will",  "can" , "public", "union", "america", "time","power","peace")) %>%
ggplot(aes(year, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, ncol = 2,scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
library(methods)
library(tidyr)
data("data_corpus_inaugural", package = "quanteda")
inaug_dfm <- quanteda::dfm(data_corpus_inaugural)
inaug_td <- tidy(inaug_dfm)
year_term_counts <- inaug_td %>%
extract(document, "year", "(\\d+)", convert = TRUE) %>%
complete(year, term, fill = list(count = 0)) %>%
group_by(year) %>%
mutate(year_total = sum(count))
year_term_counts %>%
filter(term %in% c("will",  "can" , "public", "union", "america", "time","power","peace", "people")) %>%
ggplot(aes(year, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
library(methods)
library(tidyr)
data("data_corpus_inaugural", package = "quanteda")
inaug_dfm <- quanteda::dfm(data_corpus_inaugural)
inaug_td <- tidy(inaug_dfm)
year_term_counts <- inaug_td %>%
extract(document, "year", "(\\d+)", convert = TRUE) %>%
complete(year, term, fill = list(count = 0)) %>%
group_by(year) %>%
mutate(year_total = sum(count))
year_term_counts %>%
filter(term %in% c("will",  "can" , "public", "union", "america", "time","power","peace", "people")) %>%
ggplot(aes(year, count / year_total)) +
geom_point() +
geom_smooth() +
facet_wrap(~ term, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
ylab("% frequency of word in inaugural address")
speech_token %>%
count(id, word) %>%
bind_tf_idf(word, id, n) %>%
arrange(desc(tf_idf))
View(speech_tidy)
View(speech_token)
View(inaug_td)
View(speech_tidy)
freq_inaug <- inaug_td %>%
group_by(document) %>%
count(word, sort = TRUE)%>%
left_join(inaug_td %>%
group_by(document) %>%
summarise(total = n())) %>%
mutate(freq = n/total)
freq_inaug <- inaug_td %>%
group_by(document) %>%
count(term, sort = TRUE)%>%
left_join(inaug_td %>%
group_by(document) %>%
summarise(total = n())) %>%
mutate(freq = n/total)
freq_inaug
View(freq_inaug)
freq_inaug <- speech_token %>%
group_by(document) %>%
count(term, sort = TRUE)%>%
left_join(inaug_td %>%
group_by(document) %>%
summarise(total = n())) %>%
mutate(freq = n/total)
View(speech_token)
View(speech_tidy)
View(inaug.list)
speech_tidy$author <- inaug.list$ï..President
speech_tidy <- tidy(speech.corpus)
speech_tidy$author <- inaug.list$ï..President
speech_token <- speech_tidy %>%
unnest_tokens(word, text) %>%
anti_join(stop_words, by = "word")
speech_token %>%
count(word, sort = TRUE)
View(speech_token)
freq_inaug <- speech_token %>%
group_by(author) %>%
count(term, sort = TRUE)%>%
left_join(inaug_td %>%
group_by(author) %>%
summarise(total = n())) %>%
mutate(freq = n/total)
freq_inaug <- speech_token %>%
group_by(author) %>%
count(word, sort = TRUE)%>%
left_join(inaug_td %>%
group_by(author) %>%
summarise(total = n())) %>%
mutate(freq = n/total)
freq_inaug <- speech_token %>%
group_by(id) %>%
count(word, sort = TRUE)%>%
left_join(inaug_td %>%
group_by(id) %>%
summarise(total = n())) %>%
mutate(freq = n/total)
freq_inaug <- speech_token %>%
group_by(author) %>%
count(word, sort = TRUE)%>%
left_join(speech_token %>%
group_by(author) %>%
summarise(total = n())) %>%
mutate(freq = n/total)
freq_inaug
View(freq_inaug)
wordcloud(tdm.overall$word, tdm.overall$`sum(n)`,
scale=c(8,0.3),
max.words=20,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
speech_tidy <- tidy(speech.corpus)
speech_tidy$author <- inaug.list$ï..President
speech_token <- speech_tidy %>%
unnest_tokens(word, text) %>%
anti_join(stop_words, by = "word")
speech_token %>%
count(word, sort = TRUE)
View(plot_inaug)
View(inaug.list)
names(inaug.list)
View(inaug.list)
speech_tidy <- tidy(speech.corpus)
speech_tidy$author <- inaug.list$File
speech_token <- speech_tidy %>%
unnest_tokens(word, text) %>%
anti_join(stop_words, by = "word")
speech_token %>%
count(word, sort = TRUE)
freq_inaug <- speech_token %>%
group_by(author) %>%
count(word, sort = TRUE)%>%
left_join(speech_token %>%
group_by(author) %>%
summarise(total = n())) %>%
mutate(freq = n/total)
freq_inaug
View(inaug_tf_idf)
inaug_tf_idf <- freq_inaug %>%
bind_tf_idf(word, author, count) %>%
arrange(desc(tf_idf))
inaug_tf_idf <- speech_token %>%
bind_tf_idf(word, author, count) %>%
arrange(desc(tf_idf))
View(speech_token)
View(tdm.overall)
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], tdm.overall$n,
scale=c(8,0.3),
max.words=20,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
View(tdm.overall)
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(8,0.3),
max.words=20,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(8,0.3),
max.words=20,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(8,0.3),
max.words=20,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(8,0.3),
max.words=10,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"red"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"blue"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Red"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blue"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Reds"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Yellows"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
unique(freq_inaug$author)
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWBush"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
freq_inaug <- speech_token %>%
group_by(author) %>%
count(word, sort = TRUE)%>%
left_join(speech_token %>%
group_by(author) %>%
summarise(total = n())) %>%
mutate(freq = n/total)
freq_inaug
wordcloud(freq_inaug$word[freq_inaug$author == "DonaldJTrump"], freq_inaug$n,
scale=c(5,0.3),
max.words=15,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "DonaldJTrump"], freq_inaug$n,
scale=c(5,0.3),
max.words=20,
min.freq=20,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=20,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(5,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "DonaldJTrump"], freq_inaug$n,
scale=c(5,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(6,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(4,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "GeorgeWashington"], freq_inaug$n,
scale=c(4.5,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "DonaldJTrump"], freq_inaug$n,
scale=c(4.5,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "AbrahamLincoln"], freq_inaug$n,
scale=c(4.5,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "JohnFKennedy"], freq_inaug$n,
scale=c(4.5,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "JohnFKennedy"], freq_inaug$n,
scale=c(4.5,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(freq_inaug$word[freq_inaug$author == "JohnFKennedy"], freq_inaug$n,
scale=c(4.5,0.3),
max.words=30,
min.freq=10,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
